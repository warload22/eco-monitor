# –ú–∏–≥—Ä–∞—Ü–∏—è —Å Leaflet.js –Ω–∞ OpenLayers

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. –û–±–Ω–æ–≤–ª–µ–Ω—ã HTML —à–∞–±–ª–æ–Ω—ã

**templates/base.html:**
- ‚ùå –£–¥–∞–ª–µ–Ω–æ: `<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ: `<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ol@v9.1.0/ol.css">`
- ‚ùå –£–¥–∞–ª–µ–Ω–æ: `<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ: `<script src="https://cdn.jsdelivr.net/npm/ol@v9.1.0/dist/ol.js"></script>`

### 2. –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–ø–∏—Å–∞–Ω JavaScript (static/js/map.js)

#### –û—Å–Ω–æ–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:

**–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞—Ä—Ç—ã:**
```javascript
// –ë—ã–ª–æ (Leaflet):
map = L.map('map').setView([55.7558, 37.6173], 10);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

// –°—Ç–∞–ª–æ (OpenLayers):
map = new ol.Map({
    target: 'map',
    layers: [
        new ol.layer.Tile({
            source: new ol.source.OSM()
        })
    ],
    view: new ol.View({
        center: ol.proj.fromLonLat([37.6173, 55.7558]),
        zoom: 10
    })
});
```

**–ú–∞—Ä–∫–µ—Ä—ã:**
```javascript
// –ë—ã–ª–æ (Leaflet):
markersLayer = L.layerGroup().addTo(map);
const marker = L.marker([lat, lon], { icon: customIcon });

// –°—Ç–∞–ª–æ (OpenLayers):
vectorSource = new ol.source.Vector();
vectorLayer = new ol.layer.Vector({ source: vectorSource });
const feature = new ol.Feature({
    geometry: new ol.geom.Point(ol.proj.fromLonLat([lon, lat]))
});
```

**Popup'—ã:**
```javascript
// –ë—ã–ª–æ (Leaflet):
marker.bindPopup(content);

// –°—Ç–∞–ª–æ (OpenLayers):
popupOverlay = new ol.Overlay({ element: popupElement });
map.on('click', function(event) {
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–æ–≤ –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ popup
});
```

### 3. –û–±–Ω–æ–≤–ª–µ–Ω—ã —Å—Ç–∏–ª–∏ (static/css/style.css)

–î–æ–±–∞–≤–ª–µ–Ω—ã —Å—Ç–∏–ª–∏ –¥–ª—è OpenLayers popup'–æ–≤:
- `.ol-popup` - –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
- `.ol-popup-closer` - –∫–Ω–æ–ø–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è
- `.ol-popup:after`, `.ol-popup:before` - —Å—Ç—Ä–µ–ª–æ—á–∫–∞ popup'–∞

### 4. –û–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- `README.md` - –∑–∞–º–µ–Ω–µ–Ω–æ —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ Leaflet.js –Ω–∞ OpenLayers
- `templates/about.html` - –æ–±–Ω–æ–≤–ª–µ–Ω —Å–ø–∏—Å–æ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π
- `routes/api_measurements.py` - –æ–±–Ω–æ–≤–ª–µ–Ω –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –≤ docstring

### 5. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤—Å—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

‚úÖ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã —Å —Ü–µ–Ω—Ç—Ä–æ–º –Ω–∞ –ú–æ—Å–∫–≤–µ
‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ API `/api/measurements`
‚úÖ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–∞—Ä–∫–µ—Ä–æ–≤ —Å —Ü–≤–µ—Ç–æ–≤–æ–π –∏–Ω–¥–∏–∫–∞—Ü–∏–µ–π
‚úÖ Popup'—ã —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –∏–∑–º–µ—Ä–µ–Ω–∏—è—Ö
‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º –∏ —Å—Ç–∞–Ω—Ü–∏—è–º
‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–∞—Ä–∫–µ—Ä–æ–≤ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤
‚úÖ –ù–∞–≤–∏–≥–∞—Ü–∏—è –∏ –∑—É–º

## üîç –ö–ª—é—á–µ–≤—ã–µ –æ—Ç–ª–∏—á–∏—è OpenLayers –æ—Ç Leaflet

### –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
- **Leaflet**: `[latitude, longitude]` - –ø—Ä–∏–≤—ã—á–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫
- **OpenLayers**: `[longitude, latitude]` - –æ–±—Ä–∞—Ç–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫!

### –ü—Ä–æ–µ–∫—Ü–∏–∏
OpenLayers —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ø—Ä–æ–µ–∫—Ü–∏—è–º–∏:
- EPSG:4326 (WGS84) - –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã (lon/lat)
- EPSG:3857 (Web Mercator) - –ø—Ä–æ–µ–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `ol.proj.fromLonLat([lon, lat])` –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è.

### –ú–∞—Ä–∫–µ—Ä—ã
- **Leaflet**: –ü—Ä–æ—Å—Ç—ã–µ –º–∞—Ä–∫–µ—Ä—ã —á–µ—Ä–µ–∑ `L.marker()`
- **OpenLayers**: –í–µ–∫—Ç–æ—Ä–Ω—ã–µ —Å–ª–æ–∏ —Å Features –∏ Styles

### Popup'—ã
- **Leaflet**: –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ popup'—ã —á–µ—Ä–µ–∑ `bindPopup()`
- **OpenLayers**: Overlays - –±–æ–ª–µ–µ –≥–∏–±–∫–∏–π, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

## üß™ –ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

### 1. –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ
source venv/bin/activate  # Linux/Mac
venv\Scripts\activate     # Windows

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
python run.py
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—Ä—Ç—ã

1. –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:5000 –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–∞—Ä—Ç–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ü–µ–Ω—Ç—Ä –∫–∞—Ä—Ç—ã –Ω–∞ –ú–æ—Å–∫–≤–µ (–ö—Ä–∞—Å–Ω–∞—è –ø–ª–æ—â–∞–¥—å –≤–∏–¥–Ω–∞)
4. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑—É–º –∏ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∞—Ä–∫–µ—Ä–æ–≤

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–∞ –∫–∞—Ä—Ç–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è —Ü–≤–µ—Ç–Ω—ã–µ –∫—Ä—É–≥–ª—ã–µ –º–∞—Ä–∫–µ—Ä—ã
2. –¶–≤–µ—Ç–∞ –¥–æ–ª–∂–Ω—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —É—Ä–æ–≤–Ω—é –∑–∞–≥—Ä—è–∑–Ω–µ–Ω–∏—è:
   - üü¢ –ó–µ–ª–µ–Ω—ã–π - –Ω–æ—Ä–º–∞
   - üü° –ñ–µ–ª—Ç—ã–π - —É–º–µ—Ä–µ–Ω–Ω–æ
   - üü† –û—Ä–∞–Ω–∂–µ–≤—ã–π - –Ω–µ–∑–¥–æ—Ä–æ–≤–æ
   - üî¥ –ö—Ä–∞—Å–Ω—ã–π - –æ–ø–∞—Å–Ω–æ

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ popup'–æ–≤

1. –ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –ª—é–±–æ–π –º–∞—Ä–∫–µ—Ä
2. –î–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è popup —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π:
   - –ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–∞–Ω—Ü–∏–∏
   - –†–∞–π–æ–Ω
   - –ü–∞—Ä–∞–º–µ—Ç—Ä –∏ –∑–Ω–∞—á–µ–Ω–∏–µ
   - –ù–æ—Ä–º–∞
   - –°—Ç–∞—Ç—É—Å (–ù–æ—Ä–º–∞/–ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ)
   - –í—Ä–µ–º—è –∏–∑–º–µ—Ä–µ–Ω–∏—è
3. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫—Ä–µ—Å—Ç–∏–∫ (√ó) –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è popup'–∞

### 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

1. –í—ã–±–µ—Ä–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä –∏–∑ —Å–ø–∏—Å–∫–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "PM2.5")
2. –ù–∞–∂–º–∏—Ç–µ "–ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã"
3. –ú–∞—Ä–∫–µ—Ä—ã –¥–æ–ª–∂–Ω—ã –æ–±–Ω–æ–≤–∏—Ç—å—Å—è - –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä
4. –í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é —Å—Ç–∞–Ω—Ü–∏—é
5. –î–æ–ª–∂–µ–Ω –æ—Å—Ç–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –º–∞—Ä–∫–µ—Ä
6. –ù–∞–∂–º–∏—Ç–µ "–°–±—Ä–æ—Å–∏—Ç—å" - –≤—Å–µ –º–∞—Ä–∫–µ—Ä—ã –¥–æ–ª–∂–Ω—ã –≤–µ—Ä–Ω—É—Ç—å—Å—è

### 6. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

1. –ù–∞–≤–µ–¥–∏—Ç–µ –∫—É—Ä—Å–æ—Ä –Ω–∞ –º–∞—Ä–∫–µ—Ä - –∫—É—Ä—Å–æ—Ä –¥–æ–ª–∂–µ–Ω –∏–∑–º–µ–Ω–∏—Ç—å—Å—è –Ω–∞ pointer
2. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ Ctrl+R (Cmd+R –Ω–∞ Mac) - –¥–∞–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –æ–±–Ω–æ–≤–∏—Ç—å—Å—è
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

## üêõ –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### –ü–æ—Ä—è–¥–æ–∫ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
OpenLayers –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ—Ä—è–¥–æ–∫ `[longitude, latitude]`, –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç Leaflet `[latitude, longitude]`. –í –∫–æ–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `ol.proj.fromLonLat()` –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è.

### –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è –º–∞—Ä–∫–µ—Ä–æ–≤
–í OpenLayers –º–∞—Ä–∫–µ—Ä—ã —Å—Ç–∏–ª–∏–∑—É—é—Ç—Å—è —á–µ—Ä–µ–∑ `ol.style.Style()`. –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `ol.style.Circle` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫—Ä—É–≥–ª—ã—Ö –º–∞—Ä–∫–µ—Ä–æ–≤ —Å —Ü–≤–µ—Ç–æ–≤–æ–π –∑–∞–ª–∏–≤–∫–æ–π.

### Popup'—ã
Popup'—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —á–µ—Ä–µ–∑ `ol.Overlay` –∏ —Ç—Ä–µ–±—É—é—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Å—Ç–∏–ª–µ–π CSS –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—Ç—Ä–µ–ª–æ—á–∫–∏.

## üìù Git –∫–æ–º–º–∏—Ç—ã

–ú–∏–≥—Ä–∞—Ü–∏—è –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–∞ –≤ –¥–≤—É—Ö –∫–æ–º–º–∏—Ç–∞—Ö:

1. **d951506** - `refactor: replace Leaflet map library with OpenLayers`
   - –û—Å–Ω–æ–≤–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏–∏
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ HTML, JS, CSS
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

2. **6ce2c1e** - `fix: update database.py for psycopg3 compatibility`
   - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å psycopg3
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–º–ø–æ—Ä—Ç–æ–≤ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [OpenLayers Documentation](https://openlayers.org/doc/)
- [OpenLayers Examples](https://openlayers.org/en/latest/examples/)
- [Coordinate Projections in OpenLayers](https://openlayers.org/en/latest/doc/tutorials/concepts.html#projection)
- [Vector Layers Tutorial](https://openlayers.org/en/latest/doc/tutorials/vectors.html)

## ‚ú® –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü—Ä–æ–µ–∫—Ç —É—Å–ø–µ—à–Ω–æ –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω —Å Leaflet.js –Ω–∞ OpenLayers v9.1.0 —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤—Å–µ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏. –í—Å–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç, popup'—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ.
